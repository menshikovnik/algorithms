Double ring queue with dynamic expansion
